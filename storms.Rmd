---
title: "Analyzing Storm Data"
author: "Egor Ignatenkov"
date: "Thursday, September 18, 2014"
output: html_document
---

First, let's get our file and read some data.

```{r download, cache=TRUE}
download.file("http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2", "stormdata.bz2")
data_header<-read.csv("stormdata.bz2", header = FALSE, nrow = 1)
take<-c("BGN_DATE", "BGN_TIME", "STATE", "EVTYPE", "FATALITIES", "INJURIES", "PROPDMG", "CROPDMG")
takecols <- ifelse(t(data_header) %in% take, NA, 'NULL')
data<-read.csv("stormdata.bz2", colClasses=takecols)
```

Let's see what we got:

```{r}
head(data, n = 10)
```

Now, let's try to answer this question:

####Across the United States, which types of events are most harmful with respect to population health?

We will have to look to the "EVTYPE" column. The data in that column is not very neat: there are some entries that differ only by uppercase/lowercase (WIND/Wind) or plural/singular form (WILDFIRE/WILDFIRES), so we'll have to do some cleaning. 

First, we get rid from rows with 0 injuries (for our purposes there's no point in dealing with WIND/Wind problems if there's no injuries stated in "Wind" entries; it's easier just to remove all such rows)

```{r}
pop_health<-aggregate(INJURIES ~ EVTYPE, data = data, sum)
pop_health
```